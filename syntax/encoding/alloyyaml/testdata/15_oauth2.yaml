otelcol.auth.oauth2:
  $label: default
  client_id: someclientid
  client_secret: someclientsecret
  endpoint_params:
    $object:
      audience:
        - someaudience
  scopes:
    - api.metrics
  timeout: 2s
  tls:
    ca_file: /var/lib/mycert.pem
    cert_file: certfile
    insecure: true
    key_file: keyfile
  token_url: https://example.com/oauth2/default/v1/token

otelcol.receiver.otlp:
  $label: default
  grpc:
    endpoint: localhost:4317
  output:
    logs:
      - expr(otelcol.exporter.otlp.default_withauth.input)
      - expr(otelcol.exporter.otlphttp.default_noauth.input)
    metrics:
      - expr(otelcol.exporter.otlp.default_withauth.input)
      - expr(otelcol.exporter.otlphttp.default_noauth.input)
    traces:
      - expr(otelcol.exporter.otlp.default_withauth.input)
      - expr(otelcol.exporter.otlphttp.default_noauth.input)

otelcol.exporter.otlp:
  $label: default_withauth
  client:
    auth: expr(otelcol.auth.oauth2.default.handler)
    endpoint: database:4317
    tls:
      ca_file: /tmp/certs/ca.pem

otelcol.exporter.otlphttp:
  $label: default_noauth
  client:
    endpoint: database:4318
    http2_ping_timeout: 0s

