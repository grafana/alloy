loki.source.file "gz" {
  targets    = [
    {__path__ = "/etc/alloy/test.log.gz", compression = "gz"},
  ]
	
  decompression {
    enabled = true
	format = "gz"
  }

  forward_to = [loki.write.test.receiver]
}

loki.source.file "z" {
  targets    = [
    {__path__ = "/etc/alloy/test.log.z", compression = "z"},
  ]
	
  decompression {
    enabled = true
	format = "z"
  }

  forward_to = [loki.write.test.receiver]
}

loki.source.file "bz2" {
  targets    = [
    {__path__ = "/etc/alloy/test.log.bz2", compression = "bz2"},
  ]
	
  decompression {
    enabled = true
	format = "bz2"
  }

  forward_to = [loki.write.test.receiver]
}


loki.write "test" {
  endpoint {
    url = "http://loki:3100/loki/api/v1/push"
  }

  external_labels = {
    test_name = "readcompressedfiles",
  }
}
